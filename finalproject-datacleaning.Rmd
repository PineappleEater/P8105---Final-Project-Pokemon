---
title: "Data Source and Data Cleaning Process"
output: html_document
---
```{r}
library(rvest)
library(tidyverse)
```


### Data Source  
The data used in this project were scraped from pokemondb.net, a resource that maintains one of the most complete collections of Pokémon information to date, encompassing all nine generations (1,025 Pokémon species including alternate forms).  
The dataset includes variables such as base statistics, physical dimensions (height and weight), and type attributes.  
A portion of the metadata is sourced from the Veekun database, with additional details compiled by community contributors based on in-game data.

I used `read_html()`, `html_table()`, and `as_tibble()` converted web page data into a tabular format.  
```{r}
raw_state_df <- read_html("data/Pokemon.html") |> 
  html_table()

raw_wh_df <- read_html("data/Pokemon by height and weight.html") |> 
  html_table()

raw_evolved_df <- read_html("data/Pokemon fully evolved.html") |> 
  html_table()
```

```{r}
pokemon_state_df <- as_tibble(raw_state_df[[1]]) |> 
  janitor::clean_names()

pokemon_df <- as_tibble(raw_wh_df[[1]]) |> 
  janitor::clean_names() |> 
  right_join(pokemon_state_df, by = c("name", "type", "number")) |> 
  
  mutate(type_split = str_extract_all(type, "[A-Z][a-z]+")) |> 
  mutate(
    type_1 = map_chr(type_split, ~ .x[1] %||% NA_character_),
    type_2 = map_chr(type_split, ~ .x[2] %||% NA_character_)
  ) |> 
  
  rename(
    dex = number
  ) |> 
  mutate(
    weight_kgs = ifelse(name == "EternatusEternamax", 9999.9, weight_kgs),
    height_m = ifelse(name == "EternatusEternamax", 999.9, height_m),
    bmi = ifelse(name == "EternatusEternamax", round(9999.9/(999.9^2),1), bmi)
  ) |> 
  select(dex, name, type_1, type_2, 
         total, hp, attack, defense, sp_atk, sp_def, speed, 
         height_m, weight_kgs, bmi, 
         -height_ft, -weight_lbs, -type_split, -type)



write_csv(pokemon_df, "data result/pokemon_data.csv")
```

Note: For "Eternamax" Eternatus, no official height or weight data exists. Based on its in-game appearance and the way it is portrayed in the anime—as a colossal, rift-like dragon composed of red energy, fractures, and crystalline lines—I set its size to 999.9 meters tall and 9999.9 kilograms in weight. The resulting BMI is effectively zero, perfectly matching the idea of a non-physical energy entity. This also aligns with how the anime almost never shows its full body, only fragmented sections of its form.

```{r}
# About Legendary of Pokémon:
pokemon_legend <- pokemon_df |> 
  filter(dex %in% c(144, 145, 146, 150, 
                    243, 244, 245, 249, 250, 
                    377, 378, 379, 380, 381, 382, 383, 384, 
                    480, 481, 482, 483, 484, 485, 486, 487, 488, 
                    638, 639, 640, 641, 642, 643, 644, 645, 646, 
                    716, 717, 718, 
                    772, 773, 785, 786, 787, 788, 789, 790, 791, 792, 
                    800, 888, 889, 890, 891, 892, 894, 895, 896, 897, 898, 905, 
                    1001, 1002, 1003, 1004, 1007, 1008, 1014, 1015, 1016, 1017, 1024))


# About Mythical of Pokémon:
pokemon_myth <- pokemon_df |> 
  filter(dex %in% c(151, 
                    251, 
                    385, 386, 
                    489, 490, 491, 492, 493, 
                    494, 647, 684, 689, 
                    719, 720, 721, 
                    801, 802, 807, 808, 809, 
                    893, 
                    1025))


# About Paradox of Pokémon:
pokemon_para <- pokemon_df |> 
  filter(dex %in% c(984:995, 1005:1010, 1020:1023))


# About Ultra Beast of Pokémon:
pokemon_ub <- pokemon_df |> 
  filter(dex %in% c(793:799, 803:806))
```

```{r}
# About Final form list of Pokémon:
pokemon_evolved_n <- raw_evolved_df[[1]] |> 
  as_tibble(.name_repair = "unique") |> 
  janitor::clean_names() |> 
  rename(dex = number) |> 
  select(dex)

pokemon_evolved_df <- pokemon_df |> 
  filter(dex %in% pokemon_evolved_n$dex)
legend_evolved_df <- pokemon_legend |> 
  filter(dex %in% pokemon_evolved_n$dex)
myth_evolved_df <- pokemon_myth |> 
  filter(dex %in% pokemon_evolved_n$dex)

```   
### Cleaned Datasets   
#### There are total 8 datasets for future analysis, included:   
`pokemon_df`: Dataset that included all 9 Generation of Pokémon states, height and weight.   
`pokemon_evolved_n`: Sub dataset `pokemon_df` for that only included **Fully Evolved Pokémon**.  

`pokemon_legend`: Sub dataset `pokemon_df` for that only included **Legendary Pokémon**  
`pokemon_myth`: Sub dataset `pokemon_df` for that only included **Mythical Pokémon**  
`pokemon_para`: Sub dataset `pokemon_df` for that only included **Paradox Pokémon**  
`pokemon_ub`: Sub dataset `pokemon_df` for that only included **Ultra Beast Pokémon**  

`legend_evolved_df`: Auxiliary dataset only included *Fully Evolved* **Legendary Pokémon**  
`myth_evolved_df`: Auxiliary dataset only included *Fully Evolved* **Mythical Pokémon**  


#### The cleaned dataset is tidy, readable and analyzable. It includes the following variables:  
`dex` **National Pokédex number**  
A unique integer identifier assigned to each Pokémon species in the National Pokédex.  
`name` **Species name**.  
The official English name of the Pokémon species or form.  
`type_1` **Primary typing**.  
The Pokémon’s first (primary) elemental type, such as Fire, Water, Grass, etc.  
`type_2` **Secondary typing**.  
The Pokémon’s second elemental type.  
If a Pokémon is monotype, this value is `NA`.  
`total` **Base Stat Total (BST)**.  
The sum of all six base stats (HP, Attack, Defense, Special Attack, Special Defense, Speed).  
This is a common indicator of overall stat strength.  
`hp` **Base HP (Hit Points)**.  
Determines how much damage the Pokémon can take before fainting.  
`attack` **Base Attack**.  
Affects the power of physical (non-special) moves used by the Pokémon.  
`defence` **Base Defense**.  
Reduces damage taken from physical (non-special) moves.  
`sp_atk` **Base Special Attack**.  
Affects the power of special-category moves (moves using the Special Attack stat).  
`sp_def` **Base Special Defense**.  
Reduces damage taken from special-category moves.  
`speed` **Base Speed**.  
Determines the order of actions in battle; higher Speed moves first.  
`height_m` **Official height (meters)**.  
The height of the Pokémon species as listed in the official Pokédex, measured in meters.  
`weight_kg` **Official weight (kilograms)**.  
The weight of the Pokémon species as listed in the official Pokédex.  
`bmi` **Body Mass Index (derived variable)**.  
A numerical value calculated as:  
$BMI = \frac{weight(kg)}{(height(m))^2}$  
Used in this dataset only as a mathematical descriptor—  
does not reflect health/evaluation in Pokémon canon.  
```{r}
#Final dataset


```